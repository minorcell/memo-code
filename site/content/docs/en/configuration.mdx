---
title: 'Configuration'
description: 'Provider, config.toml, environment variables, and MCP settings.'
order: 3
category: 'Getting Started'
---

# Configuration

Memo uses `config.toml` to manage provider selection, model profile overrides, and MCP servers.
This page focuses on what each key means and how Memo resolves model behavior at runtime.

## Config File Location

Default:

- `~/.memo/config.toml`

If `MEMO_HOME` is set:

- config path becomes `$MEMO_HOME/config.toml`

For web auth config:

- default path is `~/.memo/server.yaml`
- set `MEMO_SERVER_CONFIG` to use a custom path

## How Config Is Applied

Memo runtime uses config in this order:

1. Select active provider by `current_provider`.
2. Read that provider's `model`.
3. Resolve model profile overrides from `model_profiles`.
4. Resolve session context window from `context_window` policy.

`/models` switch in TUI re-runs this resolution for the selected provider/model.

## Provider Configuration

### Minimal Example

```toml
current_provider = "deepseek"

[[providers.deepseek]]
name = "deepseek"
env_api_key = "DEEPSEEK_API_KEY"
model = "deepseek-chat"
base_url = "https://api.deepseek.com"
```

### Multiple Providers

```toml
current_provider = "deepseek"

[[providers.deepseek]]
name = "deepseek"
env_api_key = "DEEPSEEK_API_KEY"
model = "deepseek-chat"
base_url = "https://api.deepseek.com"

[[providers.openai]]
name = "openai"
env_api_key = "OPENAI_API_KEY"
model = "gpt-4.1-mini"
base_url = "https://api.openai.com/v1"
```

### Provider Keys

- `current_provider`
    - Default provider name for new sessions.
    - Must match one configured provider `name`.
- `providers.<name>.name`
    - Provider identifier shown in `/models`.
- `providers.<name>.env_api_key`
    - Environment variable name used as first-priority API key lookup.
- `providers.<name>.model`
    - Model ID sent to the upstream API.
- `providers.<name>.base_url` (optional)
    - OpenAI-compatible endpoint.
    - Useful for custom gateways or compatible providers.

## Model Profiles (Overrides)

Memo uses conservative defaults for model capabilities and gates request options through local
`config.toml` overrides:

```toml
[model_profiles.gpt-5]
supports_parallel_tool_calls = true
supports_reasoning_content = true
context_window = 272000

# Provider-specific override, key format: "<provider>:<model>"
[model_profiles."openai:gpt-5"]
supports_parallel_tool_calls = false
```

### Supported Fields

- `supports_parallel_tool_calls`
    - Controls whether Memo sends `parallel_tool_calls`.
- `supports_reasoning_content`
    - Controls whether reasoning content is carried in tool-call follow-up rounds.
- `context_window`
    - Session prompt/context hard limit used by Memo runtime.
    - Must be a positive number.

### Key Formats

- `[model_profiles.<model>]`
    - Model-level override, for all providers using this model name.
- `[model_profiles."provider:model"]`
    - Provider-specific override, for one provider + model pair.
    - Use quotes because `:` is in the key.

Example:

- `[model_profiles.gpt-5]` applies to any provider using `gpt-5`.
- `[model_profiles."openai:gpt-5"]` only applies when provider is `openai` and model is `gpt-5`.

## Context Window Policy

Session context window is resolved with this priority:

1. `model_profiles."provider:model".context_window`
2. `model_profiles."<model>".context_window`
3. default `120000`

Memo applies this at startup and re-applies it when switching models with `/models`.

### Practical Example

```toml
[model_profiles.gpt-5]
context_window = 272000

[model_profiles."openai:gpt-5"]
context_window = 128000
```

Result:

- `openai:gpt-5` -> `128000`
- other providers using `gpt-5` -> `272000`
- any model without `context_window` override -> `120000`

## MCP Server Configuration

### Local Stdio MCP

```toml
[mcp_servers.local_tools]
command = "npx"
args = ["-y", "@modelcontextprotocol/server-filesystem", "/your/path"]
# optional
# type = "stdio"
# stderr = "inherit" # or "pipe" / "ignore"
# [mcp_servers.local_tools.env]
# FOO = "bar"
```

### Remote Streamable HTTP MCP

```toml
[mcp_servers.remote]
type = "streamable_http"
url = "https://your-mcp-server.com/mcp"
bearer_token_env_var = "MCP_TOKEN"
# optional custom headers
# http_headers = { "X-Team" = "platform" }
# or headers = { "X-Team" = "platform" }
```

## Manage MCP with CLI

```bash
memo mcp list
memo mcp get <name>
memo mcp add <name> -- <command...>
memo mcp add <name> --url <url> --bearer-token-env-var <ENV_VAR>
memo mcp remove <name>
```

Also available:

```bash
memo mcp help
```

OAuth login/logout is supported for `streamable_http` MCP servers:

```bash
memo mcp login <name> [--scopes read,write]
memo mcp logout <name>
```

## Runtime Environment Variables

### Required for model calls

- `<provider.env_api_key>`: the env var name configured in provider config, used as first priority for API key lookup.
- `OPENAI_API_KEY`: fallback API key when provider-specific key is missing.
- `DEEPSEEK_API_KEY`: fallback API key when provider-specific key and `OPENAI_API_KEY` are missing.

### Common optional

- `MEMO_HOME`: override Memo home directory.

## Skills Discovery

Memo auto-discovers Agent Skills (`SKILL.md`) at startup and appends available skill metadata
into the runtime system prompt.

### Discovery Paths

- Project scope: project root `.<agent>/skills` directories (for example: `.agents/skills`, `.claude/skills`, `.codex/skills`)
- User scope: `$MEMO_HOME/skills` (or `~/.memo/skills`)
- Not scanned: `~/.xxx/skills` hidden directories outside Memo home

### Minimal `SKILL.md`

```md
---
name: doc-writing
description: Generate and update technical documentation.
---

# Doc Writing
```

Memo reads `name` + `description` frontmatter and exposes each discovered skill to the model as:

- `- <name>: <description> (file: <absolute-path-to-SKILL.md>)`

Users can explicitly invoke by mentioning `$skill-name` in the prompt (example: `$doc-writing`).

### Default Active Skills

You can persist a default skill activation set:

```toml
# unset: all discovered skills are active
# []: no skills active by default
active_skills = [
  "/absolute/path/to/.codex/skills/doc-writing/SKILL.md"
]
```

`active_skills` stores absolute `SKILL.md` file paths.

### Advanced tool/runtime switches

- `MEMO_SHELL_TOOL_TYPE`: `unified_exec` (default) / `shell` / `shell_command` / `disabled`.
- `MEMO_EXPERIMENTAL_TOOLS`: comma-separated subset of `read_file,list_dir,grep_files`.
    - empty value means all three are enabled.
- `MEMO_ENABLE_MEMORY_TOOL=0`: disable `get_memory`.
- `MEMO_ENABLE_COLLAB_TOOLS=0`: disable subagent tools.
- `MEMO_SUBAGENT_COMMAND`: command used to spawn subagents.
- `MEMO_SUBAGENT_MAX_AGENTS`: max concurrently running subagents (default `4`).
- `MEMO_TOOL_RESULT_MAX_CHARS`: max chars kept from a single tool result before omission hint.
- `MEMO_SANDBOX_WRITABLE_ROOTS`: comma-separated absolute paths appended to writable sandbox roots for local write tools.

### MCP auth by configuration

- `<bearer_token_env_var>`: if set in an MCP server config, Memo reads this env var and injects `Authorization: Bearer <token>` for that server.

### Notes

- `SHELL`, `USER`, and `USERNAME` are system env vars read as runtime fallback; they are not Memo-specific feature switches.

## Related

- [MCP Integration](./mcp.md)
- [Built-in Tools](./tools.md)
- [Sessions & History](./sessions-history.md)
